
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STS|SMIU transport Service</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<link rel="stylesheet" href="../style.css">
<link rel="stylesheet" href="../Signup/signup.css">
<link rel="stylesheet" href="userstyle.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../font/fontawesome-free-5.15.1-web/css/all.css">
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js"></script>
<script src="../app.js"></script>
<script src="userapp.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script src="../firebase/firebase.js"></script>
<script src="../app.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>

</head>
<link rel="icon" href="../logo/Title-logo.png" type="image/gif">
</head>
<body onload='loader(), getUser(), getAnnoucement()'>
  <input type="hidden" id="userID" >
  <div id="se-pre-con"></div>
  <!-- <script>userAuth()</script> -->
  <!-- <script>getUserData()</script> -->
    <nav class=" navbar usernavbar-color">
      <a class="navbar-brand " href="index.html">
        <img src="../logo/LOGO-YELLOW.png" height="70px" class="d-inline-block align-top main-logo " alt="SMIU TRANSPORT" loading="lazy">
      </a>
        <div>
            <ul class="navbar-nav">
                <li class="nav-item lg">
                  <button type="button" class="btn signuplgnbtn navbar-btn nav-link lgoutbtn pr-2" onclick="signOut()"><i class="fas fa-sign-out-alt m-2" aria-hidden="true"></i>Logout</button>
                </li>
            </ul>
        </div>
    </nav>
  <div class="container-fluid">
    <div class="row">
        <div class="width100">
            <div class="d-flex justify-content-between align-items-center breaking-news newsbg">
                <div class="d-flex flex-row flex-grow-1 flex-fill justify-content-center py-2 text-white px-1 news"><span class="d-flex align-items-center">&nbsp;Announcement <i class="fas fa-bullhorn m-1"></i></span></div>
                <marquee class="news-scroll" behavior="scroll" direction="left" onmouseover="this.stop();" onmouseout="this.start();">
                  <p id="announcement" onload="dummy()"></p>
                </marquee>
            </div>
        </div>
    </div>
</div>
<div id="container" class="container">
 
  <div class="accountcontainer">
    <div class="top-headings"><h6 id="userpgName"><i class="fas fa-user-circle mr-2"></i></h6> </div>
    <div class="grid-container">
      <div class="sts-hd-logo"><h4>STS Credit</h4><span id="stscrdtamnt" ><i class="fas fa-coins m-2"></i></span></div>
      <div class="sts-val"><i>(subscribtion fee is : <b id="set-subscribtion-fee"></b>)</i></div>
      <div class="id-hd lefttext">ID:</div>
      <div class="id-val righttext"><span id="userpgId"></span></div>
      <div class="email-hd lefttext">Email:</div>
      <div class="email-val righttext"><span id="userpgEmail"></span></div>
      <div class="gender-hd lefttext">Gender:</div>
      <div class="gender-val righttext"><span id="userpgGender"></span></div>
      <div class="phn-hd lefttext">Phone Number:</div>
      <div class="phn-val righttext"><span id="userpgPhone"></span></div>
      <div class="Address-hd lefttext">Address:</div>
      <div class="address-val righttext"><span id="userpgAddress"></span></div>
      <!-- <div class="subs-bus-hd"><h6>Subscribed Bus</h6><span id="user-bus-val">BUS # 1</span></div> -->
      <div class="passchng-hd"><h5>Change password</h5></div>
      <div class="old-pass-hd lefttext"><label for="useroldpass">Old password</label></div>
      <div class="old-pass-val"><input type="password" id="useroldpass" class="bordergreen"></div>
      <div class="newpass-hd lefttext"><label for="usernewpass">New password</label></div>
      <div class="newpass-val"><input type="password" id="usernewpass" name="usernewpass" class="bordergreen" placeholder="(minimum 6 charracter)"></div>
      <div class="confirm-new-pass-hd lefttext"><label for="userconfnewpass">Confirm new password</label></div>
      <div class="confirm-new-pass-val"><input type="password" id="userconfnewpass" name="userconfnewpass" class="bordergreen" placeholder="(minimum 6 charracter)"></div>
      <div class="save-pass-btn"><button  id="userpasssavebtn" onclick="changePassword()" class="signuplgnbtn savebtn"><i class="fas fa-save"></i> Save</button></div>
    </div>  
  </div>
  <div class="buscontainer">

   <div class="top-headings"><h4><i class="fas fa-bus mr-3"></i>Buses</h4> </div>
   
   <div id="Scrollparent">
     
    <div id="scrolldiv" style="overflow: auto;">
      
      <!-- <div class="accordion" id="Buses">
        <div class="card card-custom">
          <div class="card-header" id="BusOne">
            <h2 class="mb-0">
            <button class="btn btn-link bus-btn-custom" type="button" data-toggle="collapse" data-target="#collapseBusOne" aria-expanded="true" aria-controls="collapseBusOne">
              BUS # 1 
            </button>
            </h2>
            Available Seats (<span id="seats-av">23</span>)
          </div>
          <div id="collapseBusOne" class="collapse show" aria-labelledby="BusOne" data-parent="#Buses">
            <div class="card-body">
              <div class="container">
                <div class="row">
                  <div class="col">
                    <span class="mor-eve-hd">Morning</span>
                  </div>
                  <div class="col">
                    <span class="mor-eve-hd">Evening</span>
                  </div>
                </div>
                <div class="row">
                  <div class="col">
                    <span class="pnts-time-hd"><i class="fas fa-map-marker-alt mr-2"></i><b>Points</b></span>
                  </div>
                  <div class="col">
                    <span class="pnts-time-hd"><i class="fas fa-clock mr-2"></i><b>Time</b></span>
                  </div>
                  <div class="col">
                    <span class="pnts-time-hd"><i class="fas fa-map-marker-alt mr-2"></i><b>Points</b></span>
                  </div>
                  <div class="col">
                    <span class="pnts-time-hd"><i class="fas fa-clock mr-2"></i><b>Time</b></span>
                  </div>
                </div>
                <div class="row">
                  <div class="col">
                    <span>Point 1</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                  <div class="col">
                    <span>Point 1</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                </div>
                <div class="row">
                  <div class="col">
                    <span>Point 2</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                  <div class="col">
                    <span>Point 2</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                </div>
                <div class="row">
                  <div class="col">
                    <span>Point 3</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                  <div class="col">
                    <span>Point 3</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                </div>
                <div class="row">
                  <div class="col">
                    <span>Point 4</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                  <div class="col">
                    <span>Point 4</span>
                  </div>
                  <div class="col">
                    <span>00:00</span>
                  </div>
                </div>
              </div>
              <button type="submit" name="subscribe" id="subscribe" class="btn-subs" onclick="subscribe()">Subscribe</button>
            </div>
          </div>
        </div>
      </div> -->

    <div>
  </div>
</div>
   </div>
  </div>
</div>
<footer class="page-footer" >
  <div class="footer-copyright text-center py-3 footer-copyright-custom ">
      <div class="footer-container-custom">© 2020 Copyright:
          <a href="https://smiu.edu.pk/" target="_blank"> SMIU</a> <span>Created by</span>  <a href="https://talha-siddiqui-portfolio.web.app/" target="_blank"><span><i>Talha Siddiqui</i></span></a>
      </div>
  </div>
</footer>

<script>

  async function getUser(){
    let credit = document.getElementById('stscrdtamnt');
    let userName = document.getElementById('userpgName');
    let userID = document.getElementById('userpgId');
    let email = document.getElementById('userpgEmail');
    let gender = document.getElementById('userpgGender');
    let contactNo = document.getElementById('userpgPhone');
    let address = document.getElementById('userpgAddress');
    let uid = document.getElementById('userID');
    let subFee = document.getElementById('set-subscribtion-fee');

    await firebase.auth().onAuthStateChanged(function (user){
      if(user){
        firebase.database().ref(`/registered-users/${user.uid}`).on('value',res=>{
          let userData = {...res.val()}
          credit.innerHTML = userData.credit;
          userName.innerHTML=userData.userName;
          userID.innerHTML=userData.userId;
          email.innerHTML=userData.email;
          gender.innerHTML=userData.gender;
          contactNo.innerHTML=userData.contact;
          address.innerHTML=userData.address;
          uid.value = userData.key;
          // console.log(userData)  
          
          getUserBuses();
        })

        firebase.database().ref(`/subscriptionFee`).on('value',res=>{
          let subscritionFee = res.val();
          subFee.innerHTML = subscritionFee;
          // console.log(subscritionFee)  
        })
        

        // await test();
      }
    })
  }

  // getUser();
</script>
</body>
</html>

